[{"path":"http://www.michaellydeamore.com/blockstrap/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 flockstrapr authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"http://www.michaellydeamore.com/blockstrap/articles/egworkflow.html","id":"introduction-to-blockstrap","dir":"Articles","previous_headings":"","what":"Introduction to Blockstrap","title":"Example Workflow","text":"Blockstrap R package developed resampling data structures naturally come blocks. common example line-listed hospital admission data, subject may appear multiple rows. rows can grouped meaningful units sequence visits subject occur close together. refer grouping block. Blockstrap provides tools perform block bootstrap, resampling blocks rather resampling individual rows independently traditional bootstrap. document, demonstrate : Create example line-listed dataset hospital admission context Partition dataset blocks Perform block bootstrap using slice_block() function","code":""},{"path":"http://www.michaellydeamore.com/blockstrap/articles/egworkflow.html","id":"generate-an-example-dataset","dir":"Articles","previous_headings":"Introduction to Blockstrap","what":"Generate an example dataset","title":"Example Workflow","text":"illustration, use create_fake_subjectDB() function HospitalNetwork package generate fake subject database containing admission/discharge records. Note dataset includes 100100 subjects subject can one record. , df contains four columns: sID: Subject ID fID: Facility ID Adate: Admission date visit Ddate: Discharge date visit","code":"library(HospitalNetwork) set.seed(1) df <- create_fake_subjectDB()  head(df) #>       sID    fID      Adate      Ddate #>    <char> <char>     <POSc>     <POSc> #> 1:   s001    f07 2019-01-23 2019-02-02 #> 2:   s001    f01 2019-03-07 2019-03-10 #> 3:   s002    f05 2019-02-24 2019-03-03 #> 4:   s002    f10 2019-03-25 2019-03-27 #> 5:   s002    f06 2019-04-23 2019-04-27 #> 6:   s003    f09 2019-02-08 2019-02-15"},{"path":"http://www.michaellydeamore.com/blockstrap/articles/egworkflow.html","id":"group-rows-into-blocks","dir":"Articles","previous_headings":"Introduction to Blockstrap","what":"Group rows into blocks","title":"Example Workflow","text":"define block sequence visits subject occur close together, , new block begins : first record subject, difference days previous discharge (Ddate) current admission (Adate) exceeds 40 days column idx_block factor identifies block row belongs . Note rows share identical entries idx_block belong block. 125125 unique blocks dataset.","code":"df2 <- df |>     group_by(sID) |>   mutate(Adate = as.Date(Adate),          Ddate = as.Date(Ddate)) |>   arrange(Adate, .by_group= TRUE) |>   mutate(diff_time = Adate - lag(Ddate),          is_start = is.na(diff_time) | diff_time > 40,          idx_within_sid = cumsum(is_start),          idx_block = as.factor(paste0(sID, \"_\",   idx_within_sid)))  head(df2) #> # A tibble: 6 × 8 #> # Groups:   sID [3] #>   sID   fID   Adate      Ddate      diff_time is_start idx_within_sid idx_block #>   <chr> <chr> <date>     <date>     <drtn>    <lgl>             <int> <fct>     #> 1 s001  f07   2019-01-23 2019-02-02 NA days   TRUE                  1 s001_1    #> 2 s001  f01   2019-03-07 2019-03-10 33 days   FALSE                 1 s001_1    #> 3 s002  f05   2019-02-24 2019-03-03 NA days   TRUE                  1 s002_1    #> 4 s002  f10   2019-03-25 2019-03-27 22 days   FALSE                 1 s002_1    #> 5 s002  f06   2019-04-23 2019-04-27 27 days   FALSE                 1 s002_1    #> 6 s003  f09   2019-02-08 2019-02-15 NA days   TRUE                  1 s003_1 nrow(distinct(df2,idx_block)) #> [1] 125"},{"path":"http://www.michaellydeamore.com/blockstrap/articles/egworkflow.html","id":"block-bootstrap","dir":"Articles","previous_headings":"Introduction to Blockstrap","what":"Block bootstrap","title":"Example Workflow","text":"block IDs defined, use slice_block() function perform block bootstrap. , sample 10 blocks replacement: sample1 resulting dataset sampled using block bootstrap can used statistical analysis. example demonstrates sampling equal weights, slice_block() function also allows weighted sampling. instance, use block size give larger blocks higher probability selected generate sample2.","code":"sample1 <- df2 |>   group_by(idx_block) |>   slice_block(n = 10, replace=TRUE)  head(sample1) #> # A tibble: 6 × 8 #> # Groups:   idx_block [3] #>   sID   fID   Adate      Ddate      diff_time is_start idx_within_sid idx_block #>   <chr> <chr> <date>     <date>     <drtn>    <lgl>             <int> <fct>     #> 1 s037  f08   2019-01-29 2019-02-03 NA days   TRUE                  1 s037_1    #> 2 s037  f01   2019-03-10 2019-03-13 35 days   FALSE                 1 s037_1    #> 3 s039  f08   2019-02-03 2019-02-11 NA days   TRUE                  1 s039_1    #> 4 s039  f02   2019-03-14 2019-03-18 31 days   FALSE                 1 s039_1    #> 5 s039  f10   2019-04-10 2019-04-15 23 days   FALSE                 1 s039_1    #> 6 s055  f10   2019-01-16 2019-01-21 NA days   TRUE                  1 s055_1 sample2 <- df2 |>   group_by(idx_block) |>   slice_block(n = 10, replace=TRUE, weight_by = n())  sample2 #> # A tibble: 21 × 8 #> # Groups:   idx_block [9] #>    sID   fID   Adate      Ddate      diff_time is_start idx_within_sid idx_block #>    <chr> <chr> <date>     <date>     <drtn>    <lgl>             <int> <fct>     #>  1 s051  f04   2019-02-16 2019-02-17 NA days   TRUE                  1 s051_1    #>  2 s051  f05   2019-03-16 2019-03-26 27 days   FALSE                 1 s051_1    #>  3 s051  f07   2019-04-26 2019-05-05 31 days   FALSE                 1 s051_1    #>  4 s051  f04   2019-06-10 2019-06-15 36 days   FALSE                 1 s051_1    #>  5 s070  f08   2019-01-21 2019-01-26 NA days   TRUE                  1 s070_1    #>  6 s070  f05   2019-01-27 2019-01-31  1 days   FALSE                 1 s070_1    #>  7 s070  f07   2019-03-02 2019-03-03 30 days   FALSE                 1 s070_1    #>  8 s070  f03   2019-03-30 2019-04-03 27 days   FALSE                 1 s070_1    #>  9 s077  f10   2019-02-10 2019-02-17 NA days   TRUE                  1 s077_1    #> 10 s095  f04   2019-01-24 2019-02-03 NA days   TRUE                  1 s095_1    #> # ℹ 11 more rows"},{"path":"http://www.michaellydeamore.com/blockstrap/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Lydeamore. Author, maintainer. Cash Looi. Author. Kenyon Ng. Author. Mitchell O'Hara-Wild. Author.","code":""},{"path":"http://www.michaellydeamore.com/blockstrap/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lydeamore M, Looi C, Ng K, O'Hara-Wild M (2025). blockstrap: Sample dataframes group. R package version 0.0.0.9000, http://www.michaellydeamore.com/blockstrap/.","code":"@Manual{,   title = {blockstrap: Sample dataframes by a group},   author = {Michael Lydeamore and Cash Looi and Kenyon Ng and Mitchell O'Hara-Wild},   year = {2025},   note = {R package version 0.0.0.9000},   url = {http://www.michaellydeamore.com/blockstrap/}, }"},{"path":"http://www.michaellydeamore.com/blockstrap/index.html","id":"blockstrap","dir":"","previous_headings":"","what":"Sample dataframes by a group","title":"Sample dataframes by a group","text":"Sample complete groups (“blocks”) grouped data frame. package implements simple block bootstrap style sampler: instead sampling individual rows, sample entire groups preserving intra-group structure.","code":""},{"path":"http://www.michaellydeamore.com/blockstrap/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Sample dataframes by a group","text":"","code":"# install.packages(\"devtools\") remotes::install_github(\"numbats/blockstrap\")"},{"path":"http://www.michaellydeamore.com/blockstrap/index.html","id":"motivation","dir":"","previous_headings":"","what":"Motivation","title":"Sample dataframes by a group","text":"observations belonging experimental unit spread across multiple rows (e.g. multiple measurements per subject, dose combinations, time series segments), ordinary row-wise sampling breaks units apart. block sampler keeps units intact sampling group level.","code":""},{"path":"http://www.michaellydeamore.com/blockstrap/index.html","id":"core-function","dir":"","previous_headings":"","what":"Core function","title":"Sample dataframes by a group","text":"slice_block() works grouped data frame. call ungrouped data frame, throws helpful error. Key arguments: n: number groups (blocks) sample. replace: sample replacement? Needed n exceeds number groups. weight_by: optional expression (unquoted) evaluated per-group weight sampling probabilities. ...: passed base sample()","code":""},{"path":"http://www.michaellydeamore.com/blockstrap/index.html","id":"basic-example","dir":"","previous_headings":"","what":"Basic example","title":"Sample dataframes by a group","text":"use built-ToothGrowth dataset treat supplement-dose combination block.","code":"library(dplyr) library(blockstrap)  set.seed(1) ToothGrowth |>   group_by(supp, dose) |>   slice_block(n = 2) ## # A tibble: 20 × 3 ## # Groups:   supp, dose [2] ##      len supp   dose ##    <dbl> <fct> <dbl> ##  1  15.2 OJ      0.5 ##  2  21.5 OJ      0.5 ##  3  17.6 OJ      0.5 ##  4   9.7 OJ      0.5 ##  5  14.5 OJ      0.5 ##  6  10   OJ      0.5 ##  7   8.2 OJ      0.5 ##  8   9.4 OJ      0.5 ##  9  16.5 OJ      0.5 ## 10   9.7 OJ      0.5 ## 11   4.2 VC      0.5 ## 12  11.5 VC      0.5 ## 13   7.3 VC      0.5 ## 14   5.8 VC      0.5 ## 15   6.4 VC      0.5 ## 16  10   VC      0.5 ## 17  11.2 VC      0.5 ## 18  11.2 VC      0.5 ## 19   5.2 VC      0.5 ## 20   7   VC      0.5"},{"path":"http://www.michaellydeamore.com/blockstrap/index.html","id":"sampling-with-replacement","dir":"","previous_headings":"","what":"Sampling with replacement","title":"Sample dataframes by a group","text":"want sample groups exist, allow repeats: Repeated blocks appear multiple times (row counts summed accordingly).","code":"ToothGrowth |>   group_by(supp, dose) |>   slice_block(n = 10, replace = TRUE) |>   count(supp, dose) ## # A tibble: 5 × 3 ## # Groups:   supp, dose [5] ##   supp   dose     n ##   <fct> <dbl> <int> ## 1 OJ      0.5    20 ## 2 OJ      1      20 ## 3 OJ      2      30 ## 4 VC      1      20 ## 5 VC      2      10"},{"path":"http://www.michaellydeamore.com/blockstrap/index.html","id":"weighted-sampling","dir":"","previous_headings":"","what":"Weighted sampling","title":"Sample dataframes by a group","text":"Weight blocks statistic, e.g. mean tooth length, favor larger mean response groups: can verify weighting bias repeating tallying frequencies:","code":"set.seed(42) weighted <- ToothGrowth |>   group_by(supp, dose) |>   slice_block(n = 3, weight_by = mean(len)) set.seed(99) rep_draws <- replicate(500, {   ToothGrowth |> group_by(supp, dose) |> slice_block(n = 3, weight_by = mean(len)) |> distinct(supp, dose) }, simplify = FALSE)  freqs <- bind_rows(rep_draws) |> count(supp, dose, name = \"times\") |> arrange(desc(times)) freqs ## # A tibble: 6 × 3 ## # Groups:   supp, dose [6] ##   supp   dose times ##   <fct> <dbl> <int> ## 1 OJ      2     334 ## 2 VC      2     326 ## 3 OJ      1     292 ## 4 VC      1     224 ## 5 OJ      0.5   205 ## 6 VC      0.5   119"},{"path":"http://www.michaellydeamore.com/blockstrap/reference/slice_block.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample complete groups from a data frame — slice_block","title":"Sample complete groups from a data frame — slice_block","text":"Samples complete groups grouped data frame, including group part sample. Can considered form grouped bootstrap sampling.","code":""},{"path":"http://www.michaellydeamore.com/blockstrap/reference/slice_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample complete groups from a data frame — slice_block","text":"","code":"slice_block(.data, ...)  # S3 method for class 'data.frame' slice_block(.data, ...)  # S3 method for class 'grouped_df' slice_block(.data, n = 1, replace = FALSE, weight_by = NULL, ...)"},{"path":"http://www.michaellydeamore.com/blockstrap/reference/slice_block.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample complete groups from a data frame — slice_block","text":".data grouped data frame, generated using [dplyr::group_by](dplyr::group_by) ... Additional arguments passed methods n Number samples draw replace sampling done replacement? weight_by Optional expression weight groups (unquoted name)","code":""},{"path":"http://www.michaellydeamore.com/blockstrap/reference/slice_block.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample complete groups from a data frame — slice_block","text":"data frame sampled complete groups","code":""},{"path":"http://www.michaellydeamore.com/blockstrap/reference/slice_block.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample complete groups from a data frame — slice_block","text":"","code":"ToothGrowth |>    dplyr::group_by(supp, dose) |>    slice_block(n = 2) #> # A tibble: 20 × 3 #> # Groups:   supp, dose [2] #>      len supp   dose #>    <dbl> <fct> <dbl> #>  1   4.2 VC      0.5 #>  2  11.5 VC      0.5 #>  3   7.3 VC      0.5 #>  4   5.8 VC      0.5 #>  5   6.4 VC      0.5 #>  6  10   VC      0.5 #>  7  11.2 VC      0.5 #>  8  11.2 VC      0.5 #>  9   5.2 VC      0.5 #> 10   7   VC      0.5 #> 11  16.5 VC      1   #> 12  16.5 VC      1   #> 13  15.2 VC      1   #> 14  17.3 VC      1   #> 15  22.5 VC      1   #> 16  17.3 VC      1   #> 17  13.6 VC      1   #> 18  14.5 VC      1   #> 19  18.8 VC      1   #> 20  15.5 VC      1"}]
